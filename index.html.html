<script>
        let products = []; // Esta variável agora será preenchida pelo JSON

        // Referências aos elementos do DOM (mantidos)
        const productList = document.getElementById('product-list');
        const adminProductList = document.getElementById('admin-product-list');

        const productModal = document.getElementById('product-modal');
        const modalProductName = document.getElementById('modal-product-name');
        const modalProductImage = document.getElementById('modal-product-image');
        const modalProductDescription = document.getElementById('modal-product-description');
        
        const messageModal = document.getElementById('message-modal');
        const messageText = document.getElementById('message-text');

        // Admin inputs (ainda existem, mas as funções de escrita não funcionarão com JSON estático)
        const adminProductId = document.getElementById('admin-product-id');
        const adminImageUrl = document.getElementById('admin-image-url');
        const adminProductName = document.getElementById('admin-product-name');
        const adminProductDescription = document.getElementById('admin-product-description');
        const addUpdateButton = document.getElementById('add-update-button');
        const cancelEditButton = document.getElementById('cancel-edit-button');

        // --- Funções de UI (mantidas as suas existentes) ---
        function navigateTo(sectionId) {
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function showProductModal(productId) {
            // Convertendo para string para comparar com o id do JSON (que será string)
            const product = products.find(p => p.id === String(productId));
            if (product) {
                modalProductName.textContent = product.name;
                modalProductImage.src = product.image;
                modalProductDescription.textContent = product.description;
                productModal.classList.remove('hidden');
            }
        }

        function hideProductModal() {
            productModal.classList.add('hidden');
        }

        function showMessageModal(message) {
            messageText.textContent = message;
            messageModal.classList.remove('hidden');
        }

        function hideMessageModal() {
            messageModal.classList.add('hidden');
        }

        function clearAdminForm() {
            adminProductId.value = '';
            adminImageUrl.value = '';
            adminProductName.value = '';
            adminProductDescription.value = '';
            addUpdateButton.textContent = 'Adicionar Modelo';
            cancelEditButton.style.display = 'none';
        }

        function cancelEdit() {
            clearAdminForm();
            showMessageModal('Edição cancelada. Para atualizar, edite o arquivo models.json e faça o upload.');
        }

        // --- FUNÇÃO PRINCIPAL PARA CARREGAR PRODUTOS DO JSON ---
        async function loadProductsFromJson() {
            try {
                // Caminho para o seu arquivo JSON. Assumimos que está na mesma pasta.
                const response = await fetch('models.json'); 
                if (!response.ok) {
                    throw new Error(`Erro ao carregar models.json: ${response.statusText}`);
                }
                products = await response.json();
                renderProducts(); // Renderiza os produtos após carregar
            } catch (error) {
                console.error("Erro ao carregar produtos do JSON:", error);
                showMessageModal('Erro ao carregar modelos. O arquivo models.json pode estar ausente ou com erro.');
            }
        }

        // --- Funções CRUD (Modificadas/Desativadas para JSON Estático) ---

        // As funções de adicionar, atualizar e remover não podem funcionar diretamente
        // no cliente para um JSON estático. Elas apenas exibem uma mensagem.
        
        function handleAddUpdateProduct() {
            showMessageModal('Operação não disponível para arquivos JSON estáticos. Edite models.json manualmente e re-hospede para atualizar os dados.');
            clearAdminForm(); // Limpa o formulário
        }

        function removeProduct(id) {
            showMessageModal('Operação não disponível para arquivos JSON estáticos. Remova o item de models.json manualmente e re-hospede para atualizar os dados.');
        }
        
        function editProduct(id) {
            const productToEdit = products.find(p => p.id === String(id));
            if (productToEdit) {
                adminProductId.value = productToEdit.id;
                adminImageUrl.value = productToEdit.image;
                adminProductName.value = productToEdit.name;
                adminProductDescription.value = productToEdit.description;

                addUpdateButton.textContent = 'Atualizar Modelo (Verifique models.json)'; // Mensagem para o admin
                cancelEditButton.style.display = 'block';
                showMessageModal('Editando modelo. **As alterações não serão salvas no servidor.** Para persistir, edite o arquivo models.json manualmente.');
            }
        }

        // --- Função de Renderização (Adaptada para usar IDs como strings) ---

        function renderProducts() {
            productList.innerHTML = '';
            adminProductList.innerHTML = '';

            products.forEach(product => {
                // Renderizar para a seção de modelos (clientes)
                const productCard = document.createElement('div');
                productCard.className = 'bg-white rounded-lg shadow-custom overflow-hidden transform transition-transform hover:scale-105 cursor-pointer';
                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="text-xl font-semibold mb-2 text-primary-dark">${product.name}</h3>
                        <p class="text-gray-700 text-sm">${product.description.substring(0, 70)}...</p>
                        <a href="#customize-section" class="bg-accent-blue text-white px-4 py-2 rounded-lg w-full hover:bg-opacity-90 transition-colors text-base font-semibold mt-4 block text-center">Solicitar Orçamento</a>
                    </div>
                `;
                // Note que o onclick agora usa o ID como string para corresponder ao JSON
                productCard.querySelector('img').onclick = () => showProductModal(product.id);
                productCard.querySelector('h3').onclick = () => showProductModal(product.id);
                productList.appendChild(productCard);

                // Renderizar para a seção de administração
                const adminCard = document.createElement('div');
                adminCard.className = 'admin-product-card';
                adminCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <div class="details">
                        <h4>${product.name}</h4>
                        <p class="text-gray-600 text-sm">${product.description.substring(0, 100)}...</p>
                    </div>
                    <div class="actions">
                        <button class="edit-button" onclick="editProduct('${product.id}')">Editar</button>
                        <button class="remove-button" onclick="removeProduct('${product.id}')">Remover</button>
                    </div>
                `;
                adminProductList.appendChild(adminCard);
            });
        }
        
        // --- Event Listeners e Inicialização ---
        document.addEventListener('DOMContentLoaded', () => {
            loadProductsFromJson(); // Carrega os produtos do JSON ao iniciar

            // Event listener para o botão de menu mobile
            const menuButton = document.getElementById('menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (menuButton) {
                menuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            // Event listener para o formulário de administração
            // O submit agora apenas mostra uma mensagem, não altera o JSON.
            const adminForm = document.querySelector('.admin-section form');
            if (adminForm) {
                adminForm.addEventListener('submit', (e) => {
                    e.preventDefault(); // Impede o recarregamento da página
                    handleAddUpdateProduct(); // Chama a função que informa sobre a edição manual
                });
            }
        });

        // O seu `quote-form` já está configurado para o Formspree, não precisa de alterações aqui.
    </script>
</body>
</html>
